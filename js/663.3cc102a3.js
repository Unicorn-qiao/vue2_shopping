"use strict";(self["webpackChunkshopping"]=self["webpackChunkshopping"]||[]).push([[663],{9663:function(e,s,a){a.r(s),a.d(s,{default:function(){return c}});var t=function(){var e=this,s=e._self._c;return s("div",{staticClass:"create"},[s("van-nav-bar",{attrs:{fixed:"",title:e.addressId?"编辑收货地址":"新增收获地址","left-arrow":""},on:{"click-left":function(s){return e.$router.go(-1)}}}),s("div",{staticClass:"content"},[s("div",{staticClass:"title"},[e._v("收获地址")]),s("van-form",{ref:"form"},[s("van-cell-group",{attrs:{inset:""}},[s("van-field",{attrs:{label:"姓名",placeholder:"请输入收货人姓名",rules:[{required:!0,message:"请输入姓名"}]},model:{value:e.newaddress.name,callback:function(s){e.$set(e.newaddress,"name",s)},expression:"newaddress.name"}}),s("van-field",{attrs:{label:"电话",maxlength:"11",type:"tel",placeholder:"请输入收货人手机号",rules:[{required:!0,message:"请输入手机号"},{pattern:/^1[3-9]\d{9}$/,message:"手机号格式不正确"}]},model:{value:e.newaddress.phone,callback:function(s){e.$set(e.newaddress,"phone",s)},expression:"newaddress.phone"}}),s("van-field",{attrs:{label:"地区",placeholder:"请选择省/市/区",readonly:"","is-link":""},on:{click:function(s){e.showPicker=!0}},model:{value:e.address,callback:function(s){e.address=s},expression:"address"}}),s("van-popup",{attrs:{round:"",position:"bottom"},model:{value:e.showPicker,callback:function(s){e.showPicker=s},expression:"showPicker"}},[s("van-picker",{attrs:{columns:e.regionList,"show-toolbar":"","field-names":{text:"text",value:"value"}},on:{cancel:function(s){e.showPicker=!1},confirm:e.onConfirm}})],1),s("van-field",{attrs:{label:"详细地址",placeholder:"街道门牌、楼层等信息",rules:[{required:!0,message:"请输入详细地址"}]},model:{value:e.newaddress.detail,callback:function(s){e.$set(e.newaddress,"detail",s)},expression:"newaddress.detail"}})],1)],1)],1),s("div",{staticClass:"save"},[s("div",{staticClass:"btn",on:{click:e.add}},[e._v("保存")])])],1)},d=[],r=(a(4114),a(8111),a(7588),a(1701),a(3579),a(2776)),i={name:"CreateAddress",data(){return{newaddress:{name:"",phone:"",region:[],detail:""},address:"",showPicker:!1,regionList:[]}},created(){this.getRegion(),this.render(this.addressId)},computed:{addressId(){return this.$route.params.id}},methods:{async getRegion(){const{data:{list:e}}=await(0,r.$d)(),s=Object.values(e);this.regionList=s.map((e=>({text:e.name,value:e.id,children:e.city?Object.values(e.city).map((e=>({text:e.name,value:e.id,children:e.region?Object.values(e.region).map((e=>({text:e.name,value:e.id}))):[]}))):[]})))},onConfirm(e,s){let a=this.regionList;const t=[];s.forEach((e=>{a&&a[e]&&(t.push({label:a[e].text,value:a[e].value}),a=a[e].children)})),this.newaddress.region=t,this.address=e.map((e=>e)).join(" "),this.showPicker=!1},add(){Object.values(this.newaddress).some((e=>!e||Array.isArray(e)&&0===e.length))||(this.addressId?(this.$store.dispatch("address/editAdds",{addressId:this.addressId,newadds:this.newaddress}),this.$store.dispatch("address/setDefaultAdds",this.addressId),this.$store.dispatch("address/getDefaultAdds")):this.$store.dispatch("address/addNewAddress",this.newaddress),this.$toast.success("地址保存成功"),this.$router.replace("/address"))},async render(e){if(!e)return;const{data:{detail:s}}=await(0,r.Yx)(e);this.newaddress.name=s.name,this.newaddress.phone=s.phone,this.newaddress.region=Object.entries(s.region).map((([e,a])=>({text:a,value:s[`${e}_id`]}))),this.address=Object.values(s.region).map((e=>e)).join(" "),this.newaddress.detail=s.detail}}},n=i,l=a(1656),o=(0,l.A)(n,t,d,!1,null,"543b49f3",null),c=o.exports}}]);
//# sourceMappingURL=663.3cc102a3.js.map